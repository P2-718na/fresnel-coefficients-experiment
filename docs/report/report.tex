\documentclass[12pt, a4paper, twoside]{article}

\usepackage{fontspec}
\usepackage{blindtext}
\usepackage{geometry}
\usepackage{setspace}
\usepackage{titlesec}
\usepackage{indentfirst}
\usepackage{graphicx}
\usepackage[italian]{babel}
\usepackage{catchfile}

% FIXME swap to calibri on windows? no license for linux
\setmainfont{Carlito}
\titlespacing*{\section}{0px}{3mm}{1mm}
\titlespacing*{\subsection}{0px}{3mm}{1mm}
\geometry{
  left=2cm,
  right=2cm,
  top=2cm,
  bottom=2cm
}
\setlength{\parindent}{10mm}
\graphicspath{ {./assets} }

% Allow use of command \getenv{VARNAME}.
% Taken from: https://tex.stackexchange.com/questions/62010/can-i-access-system-environment-variables-from-latex-for-instance-home
\newcommand{\getenv}[2][]{
  \CatchFileEdef{\temp}{"|kpsewhich --var-value #2"}{\endlinechar=-1}%
  \if\relax\detokenize{#1}\relax\temp\else\let#1\temp\fi}

\begin{document}

\begin{center}
  \huge Misura dell'angolo di Brewster di un prisma mediante le formule di Fresnel \\ %todo this is just a placeholder title for now
  \large Francesco Platini \getenv{MAT1}. Matteo Bonacini \getenv{MAT2}.\\ % see readme on how to use this
  \today
\end{center}

% Title spacing

\section{Abstract}\label{sec:abstract}
  In questo esperimento abbiamo analizzato il comportamento di un raggio di luce
  che colpisce la superficie di un prisma di materiale ignoto.
  Abbiamo verificato che l’intensità luminosa riflessa segue l’andamento
  previsto dalle leggi di Fresnel e abbiamo misurato l’angolo di Brewster per il
  materiale del nostro prisma.
  I risultati ottenuti sono ?????????? compatibili/incompatibili

\section{Introduzione}\label{sec:introduzione}
  Quando un raggio luminoso colpisce una superficie di separazione tra due mezzi
  dielettrici con indici di rifrazione $n_1$ e $n_2$ diversi, si possono verificare
  i fenomeni della riflessione e rifrazione della luce.
  Le equazioni di Fresnel, derivabili direttamente dalle Equazioni di Maxwell,
  descrivono questo comportamento prevedendo quale frazione d'intensità
  luminosa viene riflessa e rifratta, per ciascuna delle due componenti di
  polarizzazione.
  Indichiamo con $R_\pi$ e $R_\sigma$ le frazioni d'intensità luminosa riflessa
  polarizzata, rispettivamente, parallelamente e perpendicolarmente al piano
  d'incidenza.
  Si dimostra che valgono:

  \begin{equation}
    R_\pi = \frac {
      n_2 \cos{\theta_i} - n_1 \cos{\theta_t}
    } {
      n_2” \cos{\theta_i} + n_1 \cos{\theta_t}
    }\label{eq:fresnel equation 1}
  \end{equation}

  \begin{equation}
    R_\sigma = \frac {
      n_1 \cos{\theta_i} - n_2 \cos{\theta_t}
    } {
      n_1” \cos{\theta_i} + n_2 \cos{\theta_t}
    }\label{eq:fresnel equation 2}
  \end{equation}

  \noindent dove $n_1$ e $n_2$ sono gli indici di rifrazione dei due mezzi, $\theta_i$ e
  $\theta_r$ sono gli angoli d'incidenza e rifrazione del raggio luminoso.
  Una dimostrazione rigorosa di come si ricavino queste equazioni non è oggetto
  di questo testo, ma si rimanda a Mazzoldi[1] per ulteriori approfondimenti. % todo add reference
  Variando l’angolo d'incidenza e misurando l’intensità in funzione di tale, si
  può vedere l’andamento dei due coefficienti.
  Le formule prevedono che $R_\pi$ si annulli per un certo valore di $\theta_i$,
  che indicheremo con $\theta_B$.
  Questo angolo prende il nome di Angolo di Brewster, ed è dato dalla Legge di Brewster:

  \begin{equation}
    \theta_B = \arctan{
      \frac {n_2} {n_1}as
    }\label{eq:Brewster's law}
  \end{equation}

 \noindent  L’angolo di Brewster gode di alcune proprietà utili in diverse applicazioni
  sperimentali.
  Per approfondimenti, rimandiamo a [Mazzoldi].



\section{Apparato sperimentale e svolgimento}\label{sec:apparato-sperimentale-e-svolgimento}
  \subsection{Apparato sperimentale}\label{subsec:apparato-sperimentale}
    L’apparato sperimentale, riportato in [fig.1] è formato da un prisma
    posizionato al centro di una guida circolare graduata. Il prisma è montato
    ad un servomotore (??? modello) che gli permette di ruotare con una
    risoluzione angolare di 1.0° +/- 0.5°. (todo: il goniometro ha permesso di
    misurare l’angolo iniziale da cui far partire l’acquisizione). Un laser è
    puntato verso il cristallo, e due filtri polarizzatori sono posti in mezzo
    al fascio. Alla guida rotante è collegato un sensore di intensità luminosa
    (??? Modello).
    Il servo ed il sensore sono collegati a (?? mettere davvero tutto il setup
    oppure solamente una roba) una scheda arduino, che si occupa dell’acquisizione
    dei dati.
    (todo inserisci numeri della roba)

    Todo add specifiche di tutta la roba e link to datasheet.
    ADC arduino, reference voltage e cazzate varie
    Considerazioni su come l’errore sul sensore sia determinato principalmente da difficoltà nell’allineamento e da fluttuazioni del laser.

    \begin{figure}[h]
      \centering
      \includegraphics[width=10cm]{instrumental-apparatus.png}
      \caption{
        \emph{
          Apparato sperimentale. A partire da sinistra, in senso orario,
          si trovano: laser(1), filtri polaroid(2, 3), guida circolare(4),
          prisma(5), sensore(6), Arduino(7).
        }
      }
      \label{fig:instrumental-apparatus}
    \end{figure}

  \subsection{Procedura sperimentale}\label{subsec:procedura-sperimentale}
    Abbiamo iniziato misurando l’andamento del coefficiente $R_\pi$. Partiamo posizionando il secondo polaroid in modo che la polarizzazione della luce sia parallela al lato del prisma. Il laser che abbiamo utilizzato emetteva luce polarizzata, quindi abbiamo dovuto aggiustare anche il suo angolo rispetto al polaroid. Prima di iniziare le misure, abbiamo regolato l’intensità del laser in modo che il sensore potesse rilevare un range di valori il più ampio possibile. Abbiamo quindi posizionato il sensore direttamente davanti al laser e abbiamo ruotato il primo filtro polaroid, fino a che il sensore non è riuscito a rilevare una variazione significativa di intensità.
    Per prendere le misure, abbiamo iniziato ruotando il prisma in modo da massimizzare $\theta_i$. Per raccogliere un
    punto dati abbiamo allineato il sensore con il fascio laser riflesso e ne abbiamo misurato l’intensità. Abbiamo
    ripetuto questa misura riducendo man mano il valore di $\theta_i$, fino ad arrivare il più vicino possibile a $0\deg$.
    Il nostro apparato sperimentale ci ha permesso di svolgere misure per ?? < $\theta_i$ < ??.
    Abbiamo poi ruotato il secondo polaroid di 90° e ripetuta la stessa procedura per misurare $R_\sigma$.
    In questo modo, abbiamo ottenuto le misure di intensità riflessa $I_\pi$ e $I_\sigma$ [fig ??]. Per ottenere i
    coefficienti di Fresnel, abbiamo normalizzato i dati ottenuti tenendo conto che:
    there is no difference between Rp and Rs at normal incidence
    at glancing angle in the less-dense medium the reflection coefficients are ±1,
    Come descritto in [Lipson]
    Da queste misure abbiamo ricavato anche l’angolo di Brewster, osservando per quale valore di $\theta_i$
    l’intensità $I_\pi$ si annulla.


\section{Risultati e discussione}\label{sec:risultati-e-discussione}
  \blindtext[2]

\section{Conclusioni}\label{sec:conclusioni}
  \blindtext[1]

\newpage
\section{Appendice}\label{sec:appendice}
  \subsection{Calcolo incertezza strumentale}\label{subsec:calcolo-incertezza-strumentale}
    Per effettuare le misure d'intensità luminosa, la scheda \emph{Arduino} compara
    il segnale $V_{temt}$ in uscita dal sensore \emph{TEMT6000} con il potenziale
    $V_{cc}$ dell'alimentatore.
    Dato che il segnale $V_{cc}$ può essere soggetto a fluttuazioni significative % todo precisa che le fluttuazioni avvengono in tempi maggiori a quelli del ciclo di clock di arduino
    (dell'ordine del ~10\%), abbiamo utilizzato il potenziale di riferimento
    $V_{ref}$ di \emph{Arduino} come strumento di calibrazione.
    La formula utilizzata per ottenere una misura $I_i$ (che abbiamo riportato con le
    incertezze già calcolate) è:

    % fixme questa formula è da sistemare. Il fatto è che in realtà v_temt non è
    %  espresso in volt, ma in LSB. (Intrinsecamente, dentro di lui compare di
    %  nuovo V_cc, quindi i due si semplificano.
    \begin{equation}
      I_i = k \frac {
        V_{cc} (\pm 2LSB) \cdot V_{temt} (\pm 2LSB)
      } {
        V_{ref} (\pm 0.4\%)
      }\label{eq:misura-intensità}
    \end{equation}

    \noindent con $k$ costante di proporzionalità, scelta come % todo spiega come mai. Il concetto è che basta sapere che V_ref sia fisso. 1.1V è il valore nominale, l'offset a noi non importa.
    $k = \frac {1.1} {1000 \cdot 5} (LSB \cdot V^{-1})$ in modo da ottenere
    un intervallo di valori in uscita $0 \leq I_i < 1024$ (corrispondente
    all'intervallo di \emph{output} originale, senza correzione).
    In questa formula compaiono tre diverse componenti fisiche sorgenti di errore.
    L'\emph{ADC} di \emph{ATmega328P} e il potenziale di riferimento $V_{ref}$
    di \emph{Arduino Uno} sono le principali;
    abbiamo considerato trascurabile l’incertezza strumentale del sensore, dato
    che non è riportata nel \emph{datasheet} e %todo add reference to datasheet
    qualsiasi suo effetto sarà incluso
    nelle incertezze casuali stimate in (vedi sezione 6.2). %todo add reference to section

    Abbiamo ottenuto l’incertezza dell’\emph{ADC} direttamente dal
    \emph{datasheet} di \emph{ATmega328P} (sezione 23.1 ADC  Features): % todo add reference
    il produttore indica un'incertezza massima assoluta di $\pm 2LSB$. % todo add note for LSB
    Questo valore tiene conto di tutte le possibili fonti di errore interne
    all’\emph{ADC} ed è da considerarsi come limite superiore.
    Per quanto riguarda l'incertezza del potenziale di riferimento, abbiamo
    utilizzato il lavoro di Main[ref], dove ha misurato un errore %todo add reference
    massimo dello $0.4\%$.
    Propagando gli errori nella formula (??) abbiamo ottenuto un incertezza di % add referenceee
    (??)

  \subsection{Calcolo incertezza casuale}\label{subsec:calcolo-incertezza-casuale}
    A causa di limitazioni strumentali, non ci è stato possibile ottenere un campione
    significativo di misure di intensità per ogni angolo. Possiamo comunque ottenere
    una stima delle incertezze casuali facendo una semplice assunzione: osserviamo che
    tra un angolo e un altro, il nostro apparato sperimentale non cambia; di conseguenza,
    se potessimo prendere un numero molto grande di misure per ogni valore di theta,
    ci aspetteremmo di ottenere una serie di distribuzioni di intensità $I_\theta$
    che differiscono solo per il valore medio, ma non per la deviazione standard.
    Per stimare questa deviazione standard, quindi, abbiamo calcolato la semmidispersione
    massima (miglior stima di deviazione standard per poche misure) per tutte le serie
    di misure fatte sullo stesso angolo, e come sigma abbiamo preso la media di queste.

\end{document}

%In this document somasdmeters
%were added. There is an encoding package,
%and pagesize and fontsize parameters.
